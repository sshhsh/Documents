
\section{方程的求解}
\label{sec:solve-high-equation}

\subsection{Cardano公式与Vieta替换}
\label{sec:solve-equation-with-3-degree}

对于一般的复系数一元三次方程
\begin{equation*}
  ax^3+bx^2+cx+d=0
\end{equation*}
首先可以先把它的三次方系数化为1，成为
\begin{equation*}
  x^3+ax^2+bx+c=0
\end{equation*}
这里的系数不同于原来的系数，只是为了方便仍然以$a$,$b$,$c$标识。然后仿照解二次方程的配方法，将前两项凑配三次方，因为$(x+1)^3$展开后三次方与二次方的系数比是$1:3$，所以作代换$y=x+a/3$，可以消掉二次项，成为如下形式
\begin{equation*}
  x^3+px+q=0
\end{equation*}
假定$x=u+v$是这方程的根，那么变形得
\begin{equation*}
  (u^3+v^3)+(u+v)(3uv+p)+q=0
\end{equation*}
因为是引入了两个自由变量$u$和$v$，可以加上一些额外的限制，这里就限定$3uv+p=0$，于是便得$u^3+v^3=-q$，如果令$U=u^3,V=v^3$，就有
\begin{equation*}
  U+V = -q, \  UV=-\frac{p^3}{27}
\end{equation*}
所以$U$和$V$是下面的一元二次方程的根
\begin{equation*}
  r^2+qr-\frac{p^3}{27} = 0
\end{equation*}
由二次方程的求根公式，有
\begin{equation*}
  U = \frac{-q+\sqrt{q^2+\frac{4p^3}{27}}}{2}, \  V = \frac{-q-\sqrt{q^2+\frac{4p^3}{27}}}{2}
\end{equation*}
再分别将$U$和$V$开三次方，便得出$u$和$v$，但有个问题是开三次方就能得出三个$u$和三个$v$，$u+v$的组合就能有九种，是不是都是三次方程的根呢，不是的，因为有$3uv=-p$，假定$U$的一个立方根是$u_0$，那么它的另外两个立方根就是$\omega u_0$和$\omega^2 u_0$，这里$\omega=\cos{\frac{2\pi}{3}}+i\sin{\frac{2\pi}{3}}=-\frac{1}{2}+\frac{\sqrt{3}}{2}i$是1的一个立方根，同样有$V$的三个立方根是$v_0$、$\omega v_0$和$\omega^2 v_0$，合理选取$u_0$和$v_0$使得$3u_0v_0=-p$，那么由条件$3uv=-p$的限制，$U$和$V$各自的三个立方根只能这样搭配:
\begin{eqnarray*}
  x_1 & = & u_0+v_0 \\
  x_2 & = & \omega u_0 + \omega^2 v_0 \\
  x_3 & = & \omega^2 u_0 + \omega v_0
\end{eqnarray*}
这便是三次方程$x^3+px+q=0$的全部三个解，也可以把它写成下面这样
\begin{equation}
  \label{eq:cardano-formula}
  x_{1,2,3} = \sqrt[3]{\frac{-q+\sqrt{q^2+\frac{4p^3}{27}}}{2}} + \sqrt[3]{\frac{-q-\sqrt{q^2+\frac{4p^3}{27}}}{2}}
\end{equation}
这公式称为\emph{Cardano 公式}。

注意到在解方程$x^3+px+q=0$时所作的代换$x=u+v$并且后面限定了$3uv=-p$，所以实际上我们是作了代换
\begin{equation}
  \label{eq:vieta-substitution}
  x=u-\frac{p}{3u}
\end{equation}
这替换称为\emph{Vieta 替换}，在这替换下，方程$x^3+px+q=0$化为
\begin{equation}
  \label{eq:u3-p3-27u-3+q=0}
  u^3-\frac{p^3}{27}\cdot \frac{1}{u^3}+q=0 
\end{equation}
这可以化为一个关于$u^3$的二次方程，于是$u^3$可解出(两个复数值)，再开立方便得出$u$的值，然后$x=u-\frac{p}{3u}$就是方程$x^3+px+q=0$的解，这样就算是解出了三次方程。但是有个问题是，$u^3$是从二次方程解出来的，所以有两个复数值，而对每一个进行开立方都会产生三个复数根，所以最后$u$会有6个值，是不是这三次方程就会有6个解呢？当然不是，首先可以求出$u^3$的两个值为
\[ u^3=\frac{-q \pm \sqrt{q^2+\frac{4p^3}{27}}}{2} \]
假定$u_0$满足
\[ u_0^3=\frac{-q + \sqrt{q^2+\frac{4p^3}{27}}}{2} \]
不难得到
\[ \left( -\frac{p}{3u_0} \right)^3=\frac{-q - \sqrt{q^2+\frac{4p^3}{27}}}{2} \]
这就是说，如果$u_0$满足方程\ref{eq:u3-p3-27u-3+q=0}，那么$-p/(3u_0)$也满足它，所以方程\ref{eq:u3-p3-27u-3+q=0}的六个解是可以搭配为三对的，而对于 Vieta 替换$x=u-p/(3u)$，如果记$h(u)=u-p/(3u)$，则计算便知
\[ h(u)=h(-\frac{p}{3u}) \]
所以刚才的三对$u$，每一对中的$u$经 Vieta 替换都得出相同的$x$，所以最终方程$x^3+px+q=0$只有三个复数解。

\subsection{三次方程的三角解法}
\label{sec:cubic-equation-triangle-solved}

仍然只考虑方程$x^3+px+q=0$，作代换$x=u\cos{\theta}$，得方程
\[ u^3\cos^3{\theta}+pu\cos{\theta}+q=0 \]
熟知$\cos{3\theta}=4\cos^3{\theta}-3\cos{\theta}$，所以为了将上述方程中的余弦归到同一项，令
\[ \frac{u^3}{pu}=\frac{4}{-3} \]
得到$u=2\sqrt{-p/3}$，而原方程则化为
\[ -\frac{2p}{3}\sqrt{-\frac{p}{3}}\cos{3\theta}+q=0 \]
于是就得出了$\cos{3\theta}$的值
\[ \cos{3\theta}=-\frac{3q}{2p}\sqrt{-\frac{3}{p}} \]
这里需要说明的一点是，我们的三角函数目前为止都是限制在实数范围内的，复数的余弦还是一个没有定义的概念，对此这里有两种方案，一种方案是认可方程中的系数$p$和$q$都是实数，也就是说我们只讨论实系数三次方程的三角形式的解，但是要注意的是上面的$\cos{3\theta}$的值中有开方，所以即便是实系数的三次方程，上式右端也可能是一个虚数，所以这种方案并不理想，另一方案是我们认为三角函数已经推广到复数，并认为三角函数在实数范围内的运算规则对复数仍然成立，这样就不用关注到底是实数还是复数了，反正运算法则是一样的。

得到了$\cos{3\theta}$的值，我们利用反三角求出角度$3\theta$，并进一步得出$\theta$
\[ \theta= \pm \frac{1}{3}\arccos \left( -\frac{3q}{2p}\sqrt{-\frac{3}{p}} \right) + \frac{2}{3}k\pi, \  (k=0,1,\cdots) \]
于是原三次方程的解$x=u\cos{\theta}$便可以表为
\[ x=2\sqrt{-\frac{p}{3}} \cos{\left( \pm \frac{1}{3}\arccos \left( -\frac{3q}{2p}\sqrt{-\frac{3}{p}} \right) + \frac{2}{3}k\pi \right)}, \  (k=0,1,2) \]
注意到由余弦的周期性，上面的整数$k$只需要取遍$0,1,2$便可以得到三次方程的三个解，这就是三次方程的三角形式的解。

\subsection{四次方程的解法}
\label{sec:solve-equation-with-4-degree}

\subsection{牛顿迭代法}
\label{sec:newton-iterator-method}

\subsection{题选}
\label{sec:exercise-of-solve-equation}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../elementary-math-note"
%%% End:
